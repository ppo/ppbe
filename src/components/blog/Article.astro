---

import Hero from '@/components/Hero.astro';
import Time from '@/components/Time.astro';
import ArticleMeta from '@/components/blog/ArticleMeta.astro';
import { isFutureArticle } from '@/lib/blog';
import { FORMATS } from '@/lib/format';
import { IS_DEV } from '@/settings';


// interface Props {
//   title: string | null;
//   subtitle?: string | null;
//   abstract?: string | null;
//   hero?: string | null;
//   category?: string | null;
//   tags?: string | null;
//   author: string | null;
//   publishedAt: string | null;
//   createdAt: string | null;
// }

const { article } = Astro.props;
const {
  title,
  subtitle,
  abstract,
  hero,
} = article.data;

const { Content } = await article.render();
const isFuture = isFutureArticle(article);
---


<article>
  <ArticleMeta {...article.data} />
  <div class="prose max-w-none">
    <h1 class="mb-3">{title}</h1>
    {subtitle && (
      <h2 class="mt-0">{subtitle}</h2>
    )}

    {isFuture && (
      <p class="is-future">
        Not yet published.<br>
        Come back on <Time date={article.data.publishedAt} format={FORMATS.DATETIME} />.
      </p>
    )}

    {(!isFuture || IS_DEV) && (<>
      {abstract && (<p class="article-lead">{abstract}</p>)}
      {hero && (<Hero {...hero} />)}
      <Content />
    </>)}
  </div>
</article>


<style>
  h2 {
    font-size: 1.8em;
    font-weight: var(--font-display-light);
    opacity: 0.7;
  }

  .article-lead {
    color: var(--text-dim);
    font-size: 1.1em;
    font-style: italic;
  }

  .is-future {
    color: var(--color-error);
  }
</style>
